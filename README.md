<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>A&amp;S - معرض الفساتين الملكي</title>

  <!-- ========================================
       SEO & Meta Tags
       ======================================== -->
  <meta name="description" content="A&S معرض الفساتين الملكي: اكتشف تشكيلتنا الواسعة من الفساتين الفاخرة مع إمكانية البحث والتصفية والتفاصيل والتواصل عبر واتساب." />
  <meta name="keywords" content="فساتين, معرض فساتين, فساتين سهرة, تسوق أونلاين, تخفيضات فساتين, أزياء ملكية" />
  <meta name="author" content="A&S Fashion" />
  <meta property="og:title" content="A&S - معرض الفساتين الملكي" />
  <meta property="og:description" content="اكتشف تشكيلتنا الواسعة من الفساتين الفاخرة مع إمكانية البحث والتصفية والتفاصيل والتواصل عبر واتساب." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://<YOUR_GITHUB_USERNAME>.github.io/<YOUR_REPO>/" />
  <meta property="og:image" content="images/og-image.jpg" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Favicon -->
  <link rel="icon" href="images/favicon.ico" type="image/x-icon" />

  <!-- ========================================
       استدعاء خطوط Google Fonts و Font Awesome
       ======================================== -->
  <link
    href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap"
    rel="stylesheet"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-Bx4a6oy9kaI0s5momkGumZ5qX6Ch12HaxJXhMHDL/95B2S/bR5E2wE8pQnXl16rDpD+s/COM24kTx5c6a8JD3g=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <!-- ========================================
       الأسلوب العام (Global Styles)
       ======================================== -->
  <style>
    /* ---------------------------------------------
       متغيرات الألوان والتصميم (CSS Variables)
       --------------------------------------------- */
    :root {
      --color-primary: #4b0082;       /* أرجواني ملكي */
      --color-secondary: #fff8dc;     /* كريمي فاتح */
      --color-accent: #ffd700;        /* ذهبي */
      --color-text: #2e1a47;          /* لون نص أساسي داكن */
      --color-text-light: #6c5494;    /* لون نص فرعي */
      --color-bg-card: #ffffff;       /* خلفية بطاقات المنتج */
      --color-border: #d8bfd8;        /* لون حدود العناصر */
      --color-overlay: rgba(0, 0, 0, 0.6); /* لون التعتيم للنوافذ المنبثقة */
      --transition-duration: 0.3s;    /* مدة الانتقالات */
      --input-height: 40px;           /* ارتفاع موحد للحقلوص */
      --icon-size: 18px;              /* حجم الأيقونات */
      --card-radius: 12px;            /* نصف قطر زوايا البطاقات */
      --modal-radius: 12px;           /* نصف قطر زوايا النوافذ المنبثقة */
      --shadow-light: rgba(0, 0, 0, 0.1); /* ظل خفيف */
      --shadow-heavy: rgba(0, 0, 0, 0.2); /* ظل أقوى */
      --royal-blue: #2e1a47;          /* أزرق ملكي غامق */
      --cream: #fff8dc;               /* كريم */
      --gold: #ffd700;                /* ذهبي */
      --purple-light: #d8bfd8;        /* أرجواني فاتح */

      --font-base: 'Cairo', sans-serif;
      --font-heading: 'Playfair Display', serif;
    }

    /* =============================
       تحميل ودعم Preloader
       ============================= */
    #preloader {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    #preloader .spinner {
      border: 8px solid #f3f3f3;
      border-top: 8px solid var(--gold);
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* ---------------------------------------------
       إعدادات عامة للجسم والعناوين
       --------------------------------------------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      outline: none;
    }
    html, body {
      font-family: var(--font-base);
      background-color: var(--cream);
      color: var(--color-text);
      height: 100%;
      scroll-behavior: smooth;
      overflow-x: hidden;
    }
    h1, h2, h3, h4, h5, h6 {
      font-family: var(--font-heading);
      color: var(--royal-blue);
      margin-bottom: 8px;
    }
    /* حذف الرموز الزخرفية قبل العناوين */
    h2::before,
    h3::before {
      content: "";
    }

    p {
      line-height: 1.6;
      color: var(--color-text-light);
      margin-bottom: 10px;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    img {
      display: block;
      max-width: 100%;
    }

    /* ============================================
       رأس الموقع (Header) - هيدر هامرجر
       ============================================ */
    header {
      background-color: var(--royal-blue);
      color: #fff;
      padding: 15px 20px;
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 6px var(--shadow-heavy);
    }
    header .logo {
      font-family: var(--font-heading);
      font-size: 28px;
      font-weight: 700;
      letter-spacing: 2px;
    }
    header .hamburger {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      width: 28px;
      height: 20px;
      cursor: pointer;
    }
    header .hamburger div {
      width: 100%;
      height: 3px;
      background-color: #fff;
      border-radius: 2px;
      transition: all var(--transition-duration) ease;
    }

    /* ============================================
       الشريط الجانبي (Sidebar) - هامرجر
       ============================================ */
    aside.sidebar {
      width: 260px;
      background-color: var(--cream);
      position: fixed;
      top: 0; right: 0; bottom: 0;
      border-left: 2px solid var(--gold);
      padding: 25px 15px;
      overflow-y: auto;
      transition: transform var(--transition-duration) ease;
      z-index: 999;
    }
    aside.sidebar.closed {
      transform: translateX(100%);
    }
    aside.sidebar h2 {
      font-size: 22px;
      color: var(--royal-blue);
      margin-bottom: 18px;
      text-align: center;
    }
    aside.sidebar ul.nav-links {
      list-style: none;
    }
    aside.sidebar ul.nav-links li {
      margin-bottom: 13px;
    }
    aside.sidebar ul.nav-links li a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: 500;
      color: var(--royal-blue);
      transition: background-color var(--transition-duration) ease, color var(--transition-duration) ease;
      border: 1px solid transparent;
      font-size: 15px;
    }
    aside.sidebar ul.nav-links li a .icon {
      font-size: 18px;
      width: 22px;
      text-align: center;
      color: var(--gold);
    }
    aside.sidebar ul.nav-links li a:hover {
      background-color: var(--purple-light);
      color: var(--royal-blue);
      border-color: var(--gold);
    }
    aside.sidebar .sidebar-footer {
      margin-top: 35px;
      text-align: center;
      font-size: 11px;
      color: var(--color-text-light);
    }

    /* ============================================
       قسم المحتوى الرئيسي (Main Content)
       ============================================ */
    main {
      margin-top: 65px; /* تعويض للهيدر */
      padding: 18px 25px 45px 25px;
      transition: margin 0.3s ease;
    }

    /* ============================================
       فقرة المقدمة الملكية (Hero Section)
       ============================================ */
    .hero {
      background: linear-gradient(135deg, rgba(75, 0, 130, 0.9) 0%, rgba(255, 215, 0, 0.9) 100%), url("images/hero-bg-pattern.png") center/cover no-repeat;
      color: #fff;
      padding: 75px 25px;
      border-radius: var(--card-radius);
      text-align: center;
      margin-bottom: 45px;
      box-shadow: 0 4px 14px var(--shadow-light);
      position: relative;
      overflow: hidden;
    }
    .hero h2 {
      font-size: 34px;
      margin-bottom: 18px;
      font-weight: 700;
    }
    .hero p {
      font-size: 17px;
      line-height: 1.5;
      color: #f1ede8;
      max-width: 780px;
      margin: 0 auto;
    }

    /* ============================================
       شريط البحث والفلاتر الملكي (Search & Filters)
       ============================================ */
    .search-filter-bar {
      background-color: var(--purple-light);
      padding: 18px 12px;
      border-radius: var(--card-radius);
      box-shadow: 0 2px 8px var(--shadow-light);
      margin-bottom: 35px;
    }
    .search-filter-bar .section-title {
      font-size: 22px;
      color: var(--royal-blue);
      margin-bottom: 12px;
      text-align: center;
      font-weight: 600;
    }
    /* صندوق البحث */
    .search-box {
      display: flex;
      align-items: center;
      background-color: #fff;
      border: 2px solid var(--color-border);
      border-radius: 8px;
      height: var(--input-height);
      margin-bottom: 12px;
      transition: border-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
    }
    .search-box:focus-within {
      border-color: var(--gold);
      box-shadow: 0 0 6px var(--shadow-light);
    }
    .search-box i {
      margin-right: 10px;
      margin-left: 10px;
      font-size: var(--icon-size);
      color: var(--royal-blue);
    }
    .search-box input {
      border: none;
      background: transparent;
      flex: 1;
      height: 100%;
      font-size: 15px;
      padding: 0 6px;
      color: var(--color-text);
    }
    .search-box input::placeholder {
      color: var(--color-text-light);
    }

    /* حاوية الفلاتر */
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: space-between;
    }
    .filter-box {
      position: relative;
      flex: 1 1 140px;
      display: flex;
      align-items: center;
      background-color: #fff;
      border: 2px solid var(--color-border);
      border-radius: 8px;
      height: var(--input-height);
      transition: border-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
      padding: 0 8px;
      font-size: 14px;
    }
    .filter-box:focus-within {
      border-color: var(--gold);
      box-shadow: 0 0 6px var(--shadow-light);
    }
    .filter-box i {
      margin-left: 6px;
      font-size: calc(var(--icon-size) - 2px);
      color: var(--royal-blue);
    }
    .filter-box span.label {
      font-size: 13px;
      color: var(--royal-blue);
      margin-right: 4px;
      white-space: nowrap;
      font-weight: 500;
    }
    .filter-box select {
      flex: 1;
      height: 100%;
      border: none;
      background: transparent;
      font-size: 14px;
      padding-left: 6px;
      appearance: none;
      color: var(--color-text);
      cursor: pointer;
    }
    .filter-box::after {
      content: "\f0d7";
      font-family: "Font Awesome 5 Free";
      font-weight: 900;
      position: absolute;
      top: 50%;
      left: 8px;
      transform: translateY(-50%);
      color: var(--royal-blue);
      pointer-events: none;
    }

    /* ============================================
       معرض المنتجات الملكي (Product Grid)
       ============================================ */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 24px;
      position: relative;
      min-height: 180px; /* للتأكد من ظهور مؤشر التحميل */
    }
    /* بطاقات المنتجات */
    .product-card {
      background-color: var(--bg-color, var(--cream));
      border: 1px solid var(--color-border);
      border-radius: var(--card-radius);
      overflow: hidden;
      box-shadow: 0 2px 10px var(--shadow-light);
      transition: transform var(--transition-duration) ease, box-shadow var(--transition-duration) ease, background var(--transition-duration) ease;
      position: relative;
    }
    .product-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 16px var(--shadow-heavy);
    }
    .product-card .image-wrapper {
      position: relative;
      overflow: hidden;
      height: 260px;
      background-color: #f5f5f5;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .product-card .image-wrapper img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain; /* عرض الصورة بالكامل دون قص */
      transition: transform var(--transition-duration) ease;
      cursor: pointer;
      user-select: none;
    }
    .product-card .image-wrapper:hover img {
      transform: scale(1.03);
    }
    .product-card .image-wrapper::after {
      content: "\f065";
      font-family: "Font Awesome 5 Free";
      font-weight: 900;
      position: absolute;
      top: 50%;
      right: 50%;
      transform: translate(50%, -50%) scale(0);
      font-size: 36px;
      color: rgba(255, 255, 255, 0.8);
      transition: transform var(--transition-duration) ease;
      pointer-events: none;
    }
    .product-card .image-wrapper:hover::after {
      transform: translate(50%, -50%) scale(1);
    }
    .product-card .discount {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: var(--color-accent);
      color: #fff;
      font-size: 11px;
      padding: 5px 8px;
      border-radius: 50px;
      box-shadow: 0 2px 6px var(--shadow-light);
      font-weight: 500;
    }
    .product-card .reference {
      position: absolute;
      bottom: 8px;
      left: 8px;
      background-color: rgba(46, 26, 71, 0.8);
      color: #fff;
      font-size: 11px;
      padding: 4px 6px;
      border-radius: 4px;
      font-weight: 500;
    }
    .product-card .card-content {
      padding: 12px;
      transition: background var(--transition-duration) ease;
    }
    .product-card .card-content h4 {
      font-size: 17px;
      margin-bottom: 4px;
      color: var(--royal-blue);
      height: 42px;
      overflow: hidden;
      font-weight: 600;
    }
    .product-card .card-content p.desc {
      font-size: 13px;
      color: var(--color-text-light);
      height: 36px;
      overflow: hidden;
      margin-bottom: 8px;
    }
    .product-card .card-content .price-section {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .product-card .card-content .price-section .current-price {
      font-size: 15px;
      font-weight: 600;
      color: var(--color-accent);
    }
    .product-card .card-content .price-section .old-price {
      font-size: 13px;
      text-decoration: line-through;
      color: var(--color-text-light);
    }
    .product-card .card-content .details {
      font-size: 13px;
      color: var(--color-text-light);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .product-card .card-content .details .label {
      font-weight: 600;
      color: var(--royal-blue);
    }
    .product-card .card-content .btn-group {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }
    .product-card .card-content .btn-group a {
      flex: 1;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 500;
      text-align: center;
      transition: background-color var(--transition-duration) ease, transform var(--transition-duration) ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }
    .product-card .card-content .btn-group a.inquiry {
      background-color: var(--gold);
      color: var(--royal-blue);
    }
    .product-card .card-content .btn-group a.inquiry:hover {
      background-color: #e6c200;
      transform: translateY(-2px);
    }
    .product-card .card-content .btn-group a.details-btn {
      background-color: var(--royal-blue);
      color: #fff;
    }
    .product-card .card-content .btn-group a.details-btn:hover {
      background-color: #2e1a47;
      transform: translateY(-2px);
    }

    /* ============================================
       نافذة منبثقة: تفاصيل المنتج (Product Modal)
       ============================================ */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: var(--color-overlay);
      justify-content: center;
      align-items: center;
      overflow-y: auto;
      padding: 20px;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background-color: #fff;
      border-radius: var(--modal-radius);
      width: 100%;
      max-width: 880px;
      padding: 18px;
      position: relative;
      animation: fadeInUp 0.4s ease;
      box-shadow: 0 4px 14px var(--shadow-light);
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--color-border);
      padding-bottom: 8px;
      margin-bottom: 12px;
    }
    .modal-header h3 {
      margin: 0;
      font-size: 22px;
      color: var(--royal-blue);
    }
    .modal-header .close-btn {
      font-size: 22px;
      cursor: pointer;
      color: var(--color-text-light);
      background: none;
      border: none;
    }
    .modal-body {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
    }
    .modal-body .image-gallery {
      flex: 1 1 280px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .modal-body .image-gallery img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      object-fit: contain; /* عرض كامل */
      border: 1px solid var(--color-border);
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .modal-body .image-gallery img:hover {
      box-shadow: 0 4px 12px var(--shadow-light);
      border-color: var(--gold);
    }
    .modal-body .details-section {
      flex: 1 1 260px;
    }
    .modal-body .details-section .modal-ref {
      font-size: 13px;
      color: var(--color-text-light);
      margin-bottom: 6px;
    }
    .modal-body .details-section p {
      margin-bottom: 6px;
      font-size: 15px;
      color: var(--color-text);
    }
    .modal-body .details-section p span.label {
      font-weight: 600;
      color: var(--royal-blue);
    }
    .modal-body .details-section .modal-price {
      font-size: 18px;
      color: var(--color-accent);
      font-weight: 700;
      margin: 8px 0;
    }
    .modal-body .details-section .modal-old-price {
      font-size: 14px;
      color: var(--color-text-light);
      text-decoration: line-through;
    }
    .modal-body .details-section .modal-size {
      font-size: 15px;
      color: var(--color-text);
      margin: 8px 0;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .modal-body .details-section .modal-discount {
      display: inline-block;
      background-color: var(--color-accent);
      color: #fff;
      padding: 5px 10px;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 12px;
    }
    .modal-footer {
      text-align: center;
      margin-top: 12px;
    }
    .modal-footer .whatsapp-btn {
      background: #25d366;
      background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
      color: #fff;
      padding: 10px 18px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .modal-footer .whatsapp-btn i {
      font-size: 18px;
    }
    .modal-footer .whatsapp-btn:hover {
      background: #128c7e;
      box-shadow: 0 2px 8px var(--shadow-light);
    }

    /* ============================================
       مودال تسجيل الدخول (Login Modal)
       ============================================ */
    .modal-login .modal-content {
      max-width: 380px;
    }
    .modal-login form {
      display: flex;
      flex-direction: column;
    }
    .modal-login form input {
      margin-bottom: 13px;
      padding: 10px 12px;
      border: 2px solid var(--color-border);
      border-radius: 8px;
      font-size: 15px;
      height: var(--input-height);
      transition: border-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
    }
    .modal-login form input:focus {
      border-color: var(--gold);
      box-shadow: 0 0 6px var(--shadow-light);
    }
    .modal-login form button {
      padding: 10px 12px;
      background-color: var(--royal-blue);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      cursor: pointer;
      transition: background-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
      margin-top: 5px;
    }
    .modal-login form button:hover {
      background-color: #2e1a47;
      box-shadow: 0 2px 6px var(--shadow-light);
    }

    /* ============================================
       مودال إدارة المنتجات (Admin Panel Modal)
       ============================================ */
    .modal-admin .modal-content {
      max-width: 900px;
    }
    .modal-admin h3 {
      font-size: 20px;
      margin-bottom: 12px;
      color: var(--royal-blue);
      font-weight: 600;
    }
    .modal-admin .admin-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    .modal-admin .admin-tabs button {
      flex: 1;
      padding: 8px 12px;
      background-color: var(--purple-light);
      border: 1px solid var(--color-border);
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color var(--transition-duration) ease;
    }
    .modal-admin .admin-tabs button.active {
      background-color: var(--royal-blue);
      color: #fff;
      border-color: var(--gold);
    }
    .modal-admin .admin-section {
      display: none;
    }
    .modal-admin .admin-section.active {
      display: block;
    }
    .modal-admin .admin-list {
      max-height: 340px;
      overflow-y: auto;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 15px;
      background-color: #fafafa;
    }
    .modal-admin .admin-list .admin-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px;
      border-bottom: 1px solid var(--color-border);
      font-size: 14px;
      color: var(--color-text);
    }
    .modal-admin .admin-list .admin-item:last-child {
      border-bottom: none;
    }
    .modal-admin .admin-list .admin-item .actions {
      display: flex;
      gap: 8px;
    }
    .modal-admin .admin-list .admin-item button {
      padding: 4px 8px;
      font-size: 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color var(--transition-duration) ease;
    }
    .modal-admin .admin-list .admin-item button.edit {
      background-color: var(--gold);
      color: var(--royal-blue);
    }
    .modal-admin .admin-list .admin-item button.delete {
      background-color: #e74c3c;
      color: #fff;
    }
    .modal-admin .admin-list .admin-item button.edit:hover {
      background-color: #e6c200;
    }
    .modal-admin .admin-list .admin-item button.delete:hover {
      background-color: #c0392b;
    }

    /* ============================================
       مودال إضافة/تعديل المنتج (Add/Edit Product Modal)
       ============================================ */
    .modal-add-product .modal-content {
      max-width: 680px;
    }
    .modal-add-product form {
      display: flex;
      flex-direction: column;
    }
    .modal-add-product form input[type="text"],
    .modal-add-product form input[type="number"],
    .modal-add-product form textarea {
      margin-bottom: 13px;
      padding: 10px 12px;
      border: 2px solid var(--color-border);
      border-radius: 8px;
      font-size: 15px;
      height: var(--input-height);
      transition: border-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
    }
    .modal-add-product form input[type="text"]:focus,
    .modal-add-product form input[type="number"]:focus,
    .modal-add-product form textarea:focus {
      border-color: var(--gold);
      box-shadow: 0 0 6px var(--shadow-light);
    }
    .modal-add-product form input[type="file"] {
      margin-bottom: 13px;
    }
    .modal-add-product form button {
      padding: 10px 12px;
      background-color: var(--royal-blue);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      cursor: pointer;
      transition: background-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
      margin-top: 8px;
    }
    .modal-add-product form button:hover {
      background-color: #2e1a47;
      box-shadow: 0 2px 6px var(--shadow-light);
    }

    /* ============================================
       قسم "من نحن" الملكي (About Section)
       ============================================ */
    #about {
      background-color: #fff;
      padding: 35px 28px;
      border-radius: var(--card-radius);
      box-shadow: 0 2px 10px var(--shadow-light);
      margin-bottom: 45px;
    }
    #about h2 {
      font-size: 26px;
      margin-bottom: 18px;
      text-align: center;
      font-weight: 600;
    }
    #about p {
      font-size: 15px;
      color: var(--color-text-light);
      margin-bottom: 14px;
      text-align: justify;
    }

    /* ============================================
       قسم "خدماتنا" الملكي (Services Section)
       ============================================ */
    #services {
      background: linear-gradient(135deg, var(--purple-light) 0%, var(--cream) 100%);
      padding: 35px 28px;
      border-radius: var(--card-radius);
      box-shadow: 0 2px 10px var(--shadow-light);
      margin-bottom: 45px;
    }
    #services h2 {
      font-size: 26px;
      margin-bottom: 18px;
      text-align: center;
      font-weight: 600;
      color: var(--royal-blue);
    }
    #services .service-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 22px;
    }
    .service-card {
      background-color: #fff;
      border: 1px solid var(--color-border);
      border-radius: var(--card-radius);
      padding: 18px;
      text-align: center;
      box-shadow: 0 2px 8px var(--shadow-light);
      transition: transform var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
    }
    .service-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 14px var(--shadow-heavy);
    }
    .service-card i {
      font-size: 38px;
      color: var(--royal-blue);
      margin-bottom: 14px;
    }
    .service-card h3 {
      font-size: 18px;
      color: var(--royal-blue);
      margin-bottom: 8px;
      font-weight: 600;
    }
    .service-card p {
      font-size: 14px;
      color: var(--color-text-light);
      text-align: justify;
    }

    /* ============================================
       قسم "سياسة الخصوصية" الملكي (Privacy Policy Section)
       ============================================ */
    #privacy {
      background-color: #fff;
      padding: 35px 28px;
      border-radius: var(--card-radius);
      box-shadow: 0 2px 10px var(--shadow-light);
      margin-bottom: 45px;
    }
    #privacy h2 {
      font-size: 26px;
      margin-bottom: 18px;
      text-align: center;
      font-weight: 600;
    }
    #privacy p {
      font-size: 14px;
      color: var(--color-text-light);
      margin-bottom: 14px;
      text-align: justify;
    }

    /* ============================================
       قسم "تواصل معنا" الملكي (Contact Section)
       ============================================ */
    #contact {
      background: linear-gradient(135deg, var(--cream) 0%, var(--purple-light) 100%);
      padding: 35px 28px;
      border-radius: var(--card-radius);
      box-shadow: 0 2px 10px var(--shadow-light);
      margin-bottom: 45px;
    }
    #contact h2 {
      font-size: 26px;
      margin-bottom: 18px;
      text-align: center;
      color: var(--royal-blue);
      font-weight: 600;
    }
    #contact p {
      font-size: 15px;
      color: var(--color-text-light);
      margin-bottom: 10px;
      text-align: center;
    }
    #contact .contact-info {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      font-size: 17px;
      font-weight: 600;
      color: var(--royal-blue);
      margin-bottom: 18px;
    }
    #contact form {
      max-width: 460px;
      margin: 0 auto;
    }
    #contact form .input-group {
      position: relative;
      margin-bottom: 12px;
    }
    #contact form .input-group i {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      font-size: var(--icon-size);
      color: var(--color-text-light);
      transition: color var(--transition-duration) ease;
    }
    #contact form input,
    #contact form textarea {
      width: 100%;
      padding: 10px 40px 10px 12px;
      border: 2px solid var(--color-border);
      border-radius: 8px;
      font-size: 15px;
      transition: border-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
    }
    #contact form input:focus,
    #contact form textarea:focus {
      border-color: var(--gold);
      box-shadow: 0 0 6px var(--shadow-light);
    }
    #contact form button {
      background-color: var(--royal-blue);
      color: #fff;
      padding: 10px 18px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      cursor: pointer;
      transition: background-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
      display: flex;
      align-items: center;
      gap: 6px;
      margin: 0 auto;
    }
    #contact form button i {
      font-size: 16px;
    }
    #contact form button:hover {
      background-color: #2e1a47;
      box-shadow: 0 2px 6px var(--shadow-light);
    }

    /* ============================================
       أيقونة ثابتة للتواصل عبر واتساب الملكية (Icon)
       ============================================ */
    .whatsapp-icon-fixed {
      position: fixed;
      left: 20px;
      bottom: 20px;
      z-index: 1000;
      width: 60px;
      height: 60px;
      background: url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="%23FFFFFF" d="M380.9 97.1C339 55.2 287.2 32 232.2 32 104.3 32 0 136.3 0 264c0 54 17.7 104.5 50.2 146.6L0 480l72.3-47.7C117.2 439.5 174.1 464 233 464c127.9 0 232.2-104.3 232.2-232 0-54.9-23.2-106.5-63.3-143.9zM233 427.9c-50.3 0-97-14.3-136.5-41.4l-9.7-6-42.9 28.3 28.8-41.4-6.3-10c-26.6-42.2-40.6-91.9-40.6-143C26.9 129.1 129.2 26.8 233 26.8c104 0 187.2 84.7 187.2 187.2S337 401.9 233 401.9zm101.5-135.3c-5.5-2.7-32.5-16-37.6-17.8s-8.1-2.7-11.5 2.7-13.2 17.8-16.2 21.5c-3 3.7-6.1 4.2-11.6 1.4s-21.5-7.9-41-25.3c-15.2-13.5-25.5-30.2-28.5-34.1-3-3.7-.3-5.7 2.4-8.4 2.4-2.4 5.5-6.1 8.2-9.2 2.7-3.2 3.7-5.5 5.5-9.2.9-3.7.5-6.8-.3-9.5s-11.5-28-15.8-38.4c-4.2-10.7-8.5-9.3-11.5-9.5-3-.2-6.5-.3-9.9-.3-3.4 0-9.5 1.2-14.5 6.1s-19 18.6-19 45.4 19.5 52.6 22.3 56.2c2.7 3.7 38.5 58.9 93.2 82.6 34.5 14.9 39 12.5 46 11.7 7-.8 22.7-9.3 25.9-18.2 3.3-8.9 3.3-16.5 2.4-18.2-.9-1.8-3.3-2.7-7-5.5z"/></svg>') no-repeat center/cover;
      background-color: #25d366;
      border-radius: 50%;
      box-shadow: 0 4px 12px var(--shadow-heavy);
      cursor: pointer;
      transition: transform var(--transition-duration) ease;
    }
    .whatsapp-icon-fixed:hover {
      transform: scale(1.1);
    }

    /* ============================================
       زر العودة للأعلى (Back to Top Button)
       ============================================ */
    .back-to-top {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 48px;
      height: 48px;
      background-color: var(--gold);
      color: var(--royal-blue);
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 4px 12px var(--shadow-heavy);
      cursor: pointer;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
      z-index: 1000;
    }
    .back-to-top.show {
      opacity: 1;
      visibility: visible;
    }
    .back-to-top:hover {
      transform: scale(1.1);
    }
    .back-to-top i {
      font-size: 18px;
    }

    /* ============================================
       الشريط السفلي (Footer)
       ============================================ */
    footer {
      background-color: var(--royal-blue);
      color: #fff;
      padding: 18px 25px;
      text-align: center;
      margin-top: 45px;
    }
    footer p {
      font-size: 13px;
    }
    footer a {
      color: var(--gold);
      text-decoration: underline;
    }

    /* ============================================
       Skeleton Loader Animations
       ============================================ */
    @keyframes pulse {
      0% { background-color: #ddd; }
      50% { background-color: #ccc; }
      100% { background-color: #ddd; }
    }
    @keyframes pulse-dark {
      0% { background-color: #444; }
      50% { background-color: #555; }
      100% { background-color: #444; }
    }

    /* ============================================
       Responsive للهواتف والأجهزة الصغيرة
       ============================================ */
    @media (max-width: 1024px) {
      aside.sidebar {
        width: 220px;
      }
      main {
        padding: 18px 18px 40px 18px;
      }
      .product-card .image-wrapper {
        height: 220px;
      }
      .service-card {
        padding: 16px;
      }
      #services .service-cards {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }
    }

    @media (max-width: 768px) {
      header .hamburger {
        display: flex;
      }
      aside.sidebar {
        transform: translateX(100%);
      }
      aside.sidebar.opened {
        transform: translateX(0);
      }
      main {
        padding: 18px 12px 30px 12px;
      }
      .filters {
        flex-direction: column;
      }
      #services .service-cards {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .product-card .image-wrapper {
        height: 180px;
      }
      .modal-content {
        width: 95%;
        padding: 12px;
      }
      .modal-body {
        gap: 8px;
        flex-direction: column;
      }
      .back-to-top {
        display: none;
      }
    }
  </style>
</head>
<body>
  <!-- ======================================================
       Preloader
       ====================================================== -->
  <div id="preloader">
    <div class="spinner"></div>
  </div>

  <!-- =============================================
       رأس الموقع (Header)
       ============================================= -->
  <header>
    <div class="logo">A&amp;S</div>
    <div
      class="hamburger"
      onclick="toggleSidebar()"
      aria-label="قائمة الهامبرجر"
    >
      <div></div>
      <div></div>
      <div></div>
    </div>
  </header>

  <!-- =============================================
       الشريط الجانبي (Sidebar)
       ============================================= -->
  <aside class="sidebar closed" id="sidebar" aria-label="القائمة الجانبية">
    <h2>القائمة الرئيسية</h2>
    <ul class="nav-links">
      <li>
        <a href="#home" onclick="scrollToSection('home')">
          <span class="icon"><i class="fas fa-home"></i></span> الرئيسية
        </a>
      </li>
      <li>
        <a href="#productsSection" onclick="scrollToSection('productsSection')">
          <span class="icon"><i class="fas fa-tshirt"></i></span> المنتجات
        </a>
      </li>
      <li>
        <a href="#about" onclick="scrollToSection('about')">
          <span class="icon"><i class="fas fa-users"></i></span> من نحن
        </a>
      </li>
      <li>
        <a href="#services" onclick="scrollToSection('services')">
          <span class="icon"><i class="fas fa-concierge-bell"></i></span> خدماتنا
        </a>
      </li>
      <li>
        <a href="#privacy" onclick="scrollToSection('privacy')">
          <span class="icon"><i class="fas fa-shield-alt"></i></span> سياسة الخصوصية
        </a>
      </li>
      <li>
        <a href="#contact" onclick="scrollToSection('contact')">
          <span class="icon"><i class="fas fa-envelope"></i></span> تواصل معنا
        </a>
      </li>
      <li style="margin-top: 20px;">
        <button onclick="openLoginModal()" style="
          width: 100%;
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 8px 12px;
          background-color: var(--royal-blue);
          color: #fff;
          border: none;
          border-radius: 6px;
          font-size: 15px;
          cursor: pointer;
        ">
          <i class="fas fa-user-shield"></i> دخول المدير
        </button>
      </li>
    </ul>
    <div class="sidebar-footer">
      &copy; 2025 A&amp;S. جميع الحقوق محفوظة.
    </div>
  </aside>

  <!-- =============================================
       أيقونة ثابتة للتواصل عبر واتساب
       ============================================= -->
  <div
    class="whatsapp-icon-fixed"
    onclick="window.open('https://wa.me/967777766811', '_blank')"
    aria-label="التواصل عبر واتساب"
  ></div>

  <!-- =============================================
       زر العودة للأعلى (Back to Top)
       ============================================= -->
  <div class="back-to-top" id="backToTop" aria-label="العودة للأعلى">
    <i class="fas fa-chevron-up"></i>
  </div>

  <!-- =============================================
       المحتوى الرئيسي (Main Content)
       ============================================= -->
  <main>
    <!-- =============================================
         فقرة المقدمة الملكية (Hero Section)
         ============================================= -->
    <section id="home" class="hero" aria-labelledby="heroHeading">
      <h2 id="heroHeading">مرحباً بكم في معرض A&amp;S الملكي</h2>
      <p>
        اكتشفوا تشكيلتنا الملكية من الفساتين الفاخرة المصممة بعناية،
        واستمتعوا بتجربة تسوق فريدة تجمع بين الأناقة والجودة والترف.
      </p>
    </section>

    <!-- خط فارق -->
    <hr
      role="separator"
      style="margin: 40px 0; border: none; height: 1px; background-color: var(--color-border);"
    />

    <!-- =============================================
         قسم المنتجات الملكي (Products Section)
         ============================================= -->
    <section id="productsSection" aria-labelledby="productsHeading">
      <h2
        id="productsHeading"
        style="
          text-align: center;
          font-size: 28px;
          font-weight: 600;
          color: var(--royal-blue);
          margin-bottom: 18px;
        "
      >
        المنتجات المتوفرة
      </h2>

      <!-- شريط البحث والفلاتر الملكي -->
      <div class="search-filter-bar">
        <div class="section-title">ابحث وفلتر</div>
        <!-- صندوق البحث -->
        <div class="search-box">
          <i class="fas fa-search" aria-hidden="true"></i>
          <input
            type="text"
            id="searchInput"
            placeholder="ابحث عن فستان..."
            onkeyup="renderProducts()"
            aria-label="بحث عن فستان"
          />
        </div>

        <!-- فلاتر -->
        <div class="filters">
          <!-- فلتر المقاس -->
          <div class="filter-box" tabindex="0">
            <i class="fas fa-ruler-horizontal" aria-hidden="true"></i>
            <span class="label">المقاس</span>
            <select
              id="filterSize"
              onchange="renderProducts()"
              aria-label="فلتر المقاس"
            >
              <option value="">اختر المقاس</option>
              <option value="XS">XS</option>
              <option value="S">S</option>
              <option value="M">M</option>
              <option value="L">L</option>
              <option value="XL">XL</option>
            </select>
          </div>

          <!-- فلتر التخفيض -->
          <div class="filter-box" tabindex="0">
            <i class="fas fa-percent" aria-hidden="true"></i>
            <span class="label">التخفيض</span>
            <select
              id="filterDiscount"
              onchange="renderProducts()"
              aria-label="فلتر التخفيض"
            >
              <option value="">اختر التخفيض</option>
              <option value="10">10% فأكثر</option>
              <option value="20">20% فأكثر</option>
              <option value="30">30% فأكثر</option>
              <option value="50">50% فأكثر</option>
            </select>
          </div>

          <!-- فلتر نطاق السعر -->
          <div class="filter-box" tabindex="0">
            <i class="fas fa-tag" aria-hidden="true"></i>
            <span class="label">نطاق السعر</span>
            <select
              id="filterPriceRange"
              onchange="renderProducts()"
              aria-label="فلتر نطاق السعر"
            >
              <option value="">اختر النطاق</option>
              <option value="0-50">0 - 50 $</option>
              <option value="50-100">50 - 100 $</option>
              <option value="100-200">100 - 200 $</option>
              <option value="200-">200 $ فما فوق</option>
            </select>
          </div>
        </div>

        <!-- شريط الفرز -->
        <div
          style="
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-top: 18px;
            gap: 8px;
          "
        >
          <label
            for="sortOptions"
            style="font-size: 15px; color: var(--royal-blue); font-weight: 500;"
            >فرز حسب:</label
          >
          <select
            id="sortOptions"
            onchange="sortProducts()"
            style="
              height: var(--input-height);
              border: 2px solid var(--color-border);
              border-radius: 8px;
              padding: 0 10px;
              font-size: 14px;
            "
          >
            <option value="">اختيار</option>
            <option value="priceAsc">السعر: الأقل للأعلى</option>
            <option value="priceDesc">السعر: الأعلى للأدنى</option>
            <option value="discountDesc">التخفيض: الأكبر للأصغر</option>
          </select>
        </div>
      </div>

      <!-- شبكة عرض المنتجات -->
      <div class="product-grid" id="productGrid" aria-live="polite">
        <!-- سيتم تعبئة منتجات تجريبية وبرمجية -->
      </div>

      <!-- زر تحميل المزيد (Load More) -->
      <div id="loadMoreContainer" style="text-align: center; margin-top: 18px;">
        <button
          id="loadMoreBtn"
          onclick="loadMoreProducts()"
          style="
            padding: 10px 18px;
            background-color: var(--royal-blue);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            cursor: pointer;
          "
        >
          <i class="fas fa-arrow-down"></i> تحميل المزيد
        </button>
      </div>
    </section>

    <!-- خط فارق -->
    <hr
      role="separator"
      style="margin: 40px 0; border: none; height: 1px; background-color: var(--color-border);"
    />

    <!-- =============================================
         قسم "من نحن" الملكي (About Section)
         ============================================= -->
    <section id="about" aria-labelledby="aboutHeading">
      <h2 id="aboutHeading">من نحن</h2>
      <p>
        في A&amp;S، نقدم لكم تجربة تسوق ملكية تجمع بين الفخامة والجودة الرفيعة.
        تأسست منصتنا بهدف تقديم أجود التصاميم الملكية من الفساتين التي تناسب
        جميع المناسبات الخاصة، بدءًا من حفلات الزفاف الملكية وحتى الأمسيات
        الفاخرة.
      </p>
      <p>
        نؤمن في A&amp;S بأن الفستان ليس مجرد قطعة ملابس، بل هو تجسيد للأناقة
        والترف. نسعى دائمًا إلى اختيار أرقى الأقمشة واستخدام أحدث تقنيات
        التطريز والتطريز اليدوي ليظهر كل فستان كقطعة فنية فريدة في خزانة
        كل سيدة.
      </p>
      <p>
        كُل عميلة تمر بعملية انتقاء دقيقة، مع ضمان تجربة خدمة عملاء راقية ودعم
        احترافي لضمان رضى كل زبونة على مستوى عالمي.
      </p>
    </section>

    <!-- خط فارق -->
    <hr
      role="separator"
      style="margin: 40px 0; border: none; height: 1px; background-color: var(--color-border);"
    />

    <!-- =============================================
         قسم "خدماتنا" الملكي (Services Section)
         ============================================= -->
    <section id="services" aria-labelledby="servicesHeading">
      <h2 id="servicesHeading">خدماتنا</h2>
      <div class="service-cards">
        <div class="service-card">
          <i class="fas fa-shipping-fast"></i>
          <h3>شحن سريع وآمن</h3>
          <p>
            نقدم خدمة شحن سريع وآمن عالميًا مع تغليف ملكي فخم يحافظ على أناقة
            الفستان وجودته أثناء النقل.
          </p>
        </div>
        <div class="service-card">
          <i class="fas fa-redo"></i>
          <h3>سياسة إرجاع مرنة</h3>
          <p>
            يمكنك استرجاع أو استبدال المنتج في غضون 14 يومًا من الاستلام، مع شروط
            مرنة تناسب متطلباتك الخاصة.
          </p>
        </div>
        <div class="service-card">
          <i class="fas fa-hand-holding-heart"></i>
          <h3>دعم عملاء مخصص</h3>
          <p>
            فريقنا الملكي لخدمة العملاء متواجد على مدار الساعة للإجابة عن
            استفساراتك ومساعدتك في اختيار الفستان المثالي.
          </p>
        </div>
      </div>
    </section>

    <!-- خط فارق -->
    <hr
      role="separator"
      style="margin: 40px 0; border: none; height: 1px; background-color: var(--color-border);"
    />

    <!-- =============================================
         قسم "سياسة الخصوصية" الملكي (Privacy Policy Section)
         ============================================= -->
    <section id="privacy" aria-labelledby="privacyHeading">
      <h2 id="privacyHeading">سياسة الخصوصية</h2>
      <p>
        نحن في A&amp;S نحترم خصوصيتك ونلتزم بحماية معلوماتك الشخصية. يتم جمع
        البيانات الضرورية لعملية الشراء فقط، مثل الاسم، عنوان الشحن، معلومات
        الدفع، وذلك لضمان تقديم أفضل خدمة. لا نشارك معلوماتك مع أي أطراف ثالثة
        إلا إذا كان ذلك ضروريًا لإتمام المعاملة أو مطلوبًا بموجب القانون.
      </p>
      <p>
        تتم معالجة بيانات الدفع بأمان تام باستخدام بروتوكولات التشفير المعتمدة
        عالميًا. يمكنك الاطلاع على التفاصيل الكاملة لسياسة الخصوصية وشروط
        الاستخدام من خلال زيارة الرابط التالي:
      </p>
      <p style="text-align: center;">
        <a href="#privacy" style="font-size: 15px;">قراءة سياسة الخصوصية الكاملة</a>
      </p>
    </section>

    <!-- خط فارق -->
    <hr
      role="separator"
      style="margin: 40px 0; border: none; height: 1px; background-color: var(--color-border);"
    />

    <!-- =============================================
         قسم "تواصل معنا" الملكي (Contact Section)
         ============================================= -->
    <section id="contact" aria-labelledby="contactHeading">
      <h2 id="contactHeading">تواصل معنا</h2>
      <p class="contact-info">
        <i class="fas fa-phone"></i> واتساب: 00967 777766811
      </p>
      <p style="text-align: center;">
        أو املأ نموذج التواصل التالي، وسنعاود الاتصال بك في أسرع وقت ممكن:
      </p>
      <form onsubmit="submitContactForm(event)" aria-label="نموذج التواصل">
        <div class="input-group">
          <i class="fas fa-user"></i>
          <input
            type="text"
            id="contactName"
            placeholder="الاسم الكامل"
            required
            aria-required="true"
            aria-label="الاسم الكامل"
          />
        </div>
        <div class="input-group">
          <i class="fas fa-envelope"></i>
          <input
            type="email"
            id="contactEmail"
            placeholder="البريد الإلكتروني"
            required
            aria-required="true"
            aria-label="البريد الإلكتروني"
          />
        </div>
        <div class="input-group">
          <i class="fas fa-comment"></i>
          <textarea
            id="contactMessage"
            placeholder="رسالتك هنا..."
            rows="5"
            required
            aria-required="true"
            aria-label="رسالتك"
          ></textarea>
        </div>
        <button type="submit" aria-label="إرسال">
          <i class="fas fa-paper-plane"></i> إرسال
        </button>
      </form>
    </section>
  </main>

  <!-- =============================================
       نافذة منبثقة: تفاصيل المنتج (Product Details Modal)
       ============================================= -->
  <div class="modal" id="productModal" role="dialog" aria-modal="true" aria-labelledby="productModalTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="productModalTitle">اسم الفستان</h3>
        <button class="close-btn" onclick="closeProductModal()" aria-label="إغلاق">&times;</button>
      </div>
      <div class="modal-body">
        <div class="image-gallery" id="modalImages">
          <img src="" alt="صورة الفستان الأولى" id="modalImage1" loading="lazy" />
          <img src="" alt="صورة الفستان الثانية" id="modalImage2" loading="lazy" />
          <img src="" alt="صورة الفستان الثالثة" id="modalImage3" loading="lazy" />
        </div>
        <div class="details-section">
          <p class="modal-ref" id="modalRef">رقم المرجع: #XXXX</p>
          <p><span class="label">الوصف:</span> <span id="modalDesc"></span></p>
          <p class="modal-price" id="modalPrice">0 $</p>
          <p class="modal-old-price" id="modalOldPrice">0 $</p>
          <p class="modal-size">
            <i class="fas fa-ruler-horizontal"></i>
            <span class="label">المقاس:</span> <span id="modalSize"></span>
          </p>
          <p><span class="modal-discount" id="modalDiscount">0%</span></p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="whatsapp-btn" id="modalWhatsappBtn" aria-label="استفسار عبر واتساب">
          <i class="fab fa-whatsapp"></i> استفسر عبر واتساب
        </button>
      </div>
    </div>
  </div>

  <!-- =============================================
       نافذة منبثقة: تسجيل الدخول (Login Modal)
       ============================================= -->
  <div class="modal modal-login" id="loginModal" role="dialog" aria-modal="true" aria-labelledby="loginModalTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="loginModalTitle">تسجيل دخول المدير</h3>
        <button class="close-btn" onclick="closeLoginModal()" aria-label="إغلاق">&times;</button>
      </div>
      <div class="modal-body">
        <form onsubmit="handleLogin(event)" aria-label="نموذج تسجيل دخول">
          <div style="position: relative; margin-bottom: 15px;">
            <i
              class="fas fa-user"
              style="
                position: absolute;
                top: 50%;
                right: 12px;
                transform: translateY(-50%);
                color: var(--color-text-light);
              "
            ></i>
            <input
              type="text"
              id="loginUser"
              placeholder="اسم المستخدم"
              required
              aria-required="true"
              aria-label="اسم المستخدم"
            />
          </div>
          <div style="position: relative; margin-bottom: 15px;">
            <i
              class="fas fa-lock"
              style="
                position: absolute;
                top: 50%;
                right: 12px;
                transform: translateY(-50%);
                color: var(--color-text-light);
              "
            ></i>
            <input
              type="password"
              id="loginPass"
              placeholder="كلمة المرور"
              required
              aria-required="true"
              aria-label="كلمة المرور"
            />
          </div>
          <button type="submit" aria-label="دخول">
            <i class="fas fa-right-to-bracket"></i> دخول
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- =============================================
       نافذة منبثقة: لوحة الإدارة (Admin Panel Modal)
       ============================================= -->
  <div class="modal modal-admin" id="adminModal" role="dialog" aria-modal="true" aria-labelledby="adminModalTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="adminModalTitle">لوحة الإدارة</h3>
        <button class="close-btn" onclick="closeAdminModal()" aria-label="إغلاق">&times;</button>
      </div>
      <div class="modal-body">
        <div class="admin-tabs">
          <button id="tabAdd" class="active" onclick="switchAdminTab('add')">إضافة منتج</button>
          <button id="tabManage" onclick="switchAdminTab('manage')">إدارة المنتجات</button>
        </div>
        <!-- قسم الإضافة -->
        <div id="adminSectionAdd" class="admin-section active">
          <form
            id="addProductForm"
            onsubmit="handleAddOrUpdateProduct(event)"
            enctype="multipart/form-data"
            aria-label="نموذج إضافة/تعديل فستان"
          >
            <input type="hidden" id="editingProductId" value="" />
            <div style="position: relative; margin-bottom: 15px;">
              <i
                class="fas fa-tag"
                style="
                  position: absolute;
                  top: 50%;
                  right: 12px;
                  transform: translateY(-50%);
                  color: var(--color-text-light);
                "
              ></i>
              <input
                type="text"
                id="newDressName"
                placeholder="اسم الفستان"
                required
                aria-required="true"
                aria-label="اسم الفستان"
              />
            </div>
            <div style="position: relative; margin-bottom: 15px;">
              <i
                class="fas fa-align-left"
                style="
                  position: absolute;
                  top: 12px;
                  right: 12px;
                  color: var(--color-text-light);
                "
              ></i>
              <textarea
                id="newDressDesc"
                placeholder="وصف الفستان"
                rows="3"
                required
                aria-required="true"
                aria-label="وصف الفستان"
              ></textarea>
            </div>
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
              <div style="position: relative; flex: 1;">
                <i
                  class="fas fa-dollar-sign"
                  style="
                    position: absolute;
                    top: 50%;
                    right: 12px;
                    transform: translateY(-50%);
                    color: var(--color-text-light);
                  "
                ></i>
                <input
                  type="number"
                  id="newPriceNow"
                  placeholder="السعر الحالي ($)"
                  min="0"
                  required
                  aria-required="true"
                  aria-label="السعر الحالي"
                />
              </div>
              <div style="position: relative; flex: 1;">
                <i
                  class="fas fa-tag"
                  style="
                    position: absolute;
                    top: 50%;
                    right: 12px;
                    transform: translateY(-50%);
                    color: var(--color-text-light);
                  "
                ></i>
                <input
                  type="number"
                  id="newPriceBefore"
                  placeholder="السعر قبل التخفيض ($)"
                  min="0"
                  required
                  aria-required="true"
                  aria-label="السعر قبل التخفيض"
                />
              </div>
            </div>
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
              <div style="position: relative; flex: 1;">
                <i
                  class="fas fa-ruler-horizontal"
                  style="
                    position: absolute;
                    top: 50%;
                    right: 12px;
                    transform: translateY(-50%);
                    color: var(--color-text-light);
                  "
                ></i>
                <input
                  type="text"
                  id="newSize"
                  placeholder="المقاس (مثال: S, M, L)"
                  required
                  aria-required="true"
                  aria-label="المقاس"
                />
              </div>
              <div style="position: relative; flex: 1;">
                <i
                  class="fas fa-percent"
                  style="
                    position: absolute;
                    top: 50%;
                    right: 12px;
                    transform: translateY(-50%);
                    color: var(--color-text-light);
                  "
                ></i>
                <input
                  type="number"
                  id="newDiscount"
                  placeholder="نسبة التخفيض (%)"
                  min="0"
                  max="100"
                  required
                  aria-required="true"
                  aria-label="نسبة التخفيض"
                />
              </div>
            </div>
            <label for="newImage1" style="margin-top: 15px; font-size: 14px; font-weight: 600;">
              صورة الفستان الأولى (JPEG/PNG) <span style="color: red;">*</span>
            </label>
            <input
              type="file"
              id="newImage1"
              accept="image/*"
              required
              aria-required="true"
              aria-label="صورة الفستان الأولى"
            />
            <label for="newImage2" style="margin-top: 10px; font-size: 14px; font-weight: 600;">
              صورة الفستان الثانية (اختياري)
            </label>
            <input
              type="file"
              id="newImage2"
              accept="image/*"
              aria-label="صورة الفستان الثانية"
            />
            <label for="newImage3" style="margin-top: 10px; font-size: 14px; font-weight: 600;">
              صورة الفستان الثالثة (اختياري)
            </label>
            <input
              type="file"
              id="newImage3"
              accept="image/*"
              aria-label="صورة الفستان الثالثة"
            />
            <button type="submit" id="addUpdateBtn" aria-label="إضافة الفستان">
              <i class="fas fa-plus"></i> إضافة الفستان
            </button>
          </form>
        </div>

        <!-- قسم إدارة المنتجات -->
        <div id="adminSectionManage" class="admin-section">
          <h3>قائمة المنتجات</h3>
          <div class="admin-list" id="adminList">
            <!-- سيتم تعبئة عناصر الإدارة هنا -->
          </div>
          <p style="font-size: 13px; color: var(--color-text-light);">
            اختر "تعديل" لتعديل المنتج، أو "حذف" لإزالته نهائيًا.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- =============================================
       الشريط السفلي (Footer)
       ============================================= -->
  <footer>
    <p>&copy; 2025 A&amp;S الملكي. جميع الحقوق محفوظة. <a href="#privacy">سياسة الخصوصية</a></p>
  </footer>

  <!-- =============================================
       Firebase SDKs
       ============================================= -->
  <!-- Firebase App (core SDK) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <!-- Firebase Firestore -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

  <!-- =============================================
       سكريبت جافاسكربت (JavaScript)
       إدارة المنتجات وتفاعل المستخدم مع Firestore
       ============================================= -->
  <script>
    // =============================================
    // ---------- إعداد Firebase Firestore ----------
    // =============================================
    // 1. اذهب إلى console.firebase.google.com وأنشئ مشروعًا
    // 2. احصل على إعدادات Firebase config وألصقها في الأسطر أدناه
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY_HERE",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // =============================================
    // متغيرات أساسية للتحقق من دخول المدير
    // =============================================
    const ADMIN_USERNAME = "Alya2025";
    const ADMIN_PASSWORD = "A&S2025";

    // =============================================
    // تجزئة العناصر في DOM للسهولة
    // =============================================
    const sidebar = document.getElementById("sidebar");
    const searchInput = document.getElementById("searchInput");
    const filterSize = document.getElementById("filterSize");
    const filterDiscount = document.getElementById("filterDiscount");
    const filterPriceRange = document.getElementById("filterPriceRange");
    const productGrid = document.getElementById("productGrid");
    const sortOptions = document.getElementById("sortOptions");
    const loadMoreBtn = document.getElementById("loadMoreBtn");
    const loadMoreContainer = document.getElementById("loadMoreContainer");

    const productModal = document.getElementById("productModal");
    const modalTitle = document.getElementById("productModalTitle");
    const modalDesc = document.getElementById("modalDesc");
    const modalPrice = document.getElementById("modalPrice");
    const modalOldPrice = document.getElementById("modalOldPrice");
    const modalSize = document.getElementById("modalSize");
    const modalDiscount = document.getElementById("modalDiscount");
    const modalImage1 = document.getElementById("modalImage1");
    const modalImage2 = document.getElementById("modalImage2");
    const modalImage3 = document.getElementById("modalImage3");
    const modalRef = document.getElementById("modalRef");
    const modalWhatsappBtn = document.getElementById("modalWhatsappBtn");

    const loginModal = document.getElementById("loginModal");
    const adminModal = document.getElementById("adminModal");
    const backToTop = document.getElementById("backToTop");

    const adminSectionAdd = document.getElementById("adminSectionAdd");
    const adminSectionManage = document.getElementById("adminSectionManage");
    const tabAdd = document.getElementById("tabAdd");
    const tabManage = document.getElementById("tabManage");
    const adminList = document.getElementById("adminList");

    const addUpdateBtn = document.getElementById("addUpdateBtn");
    const editingProductIdInput = document.getElementById("editingProductId");

    // =============================================
    // Preloader وإخفاؤه بعد تحميل الصفحة
    // =============================================
    window.addEventListener("load", () => {
      const preloader = document.getElementById("preloader");
      preloader.style.opacity = "0";
      setTimeout(() => {
        preloader.style.display = "none";
      }, 500);
    });

    // =============================================
    // دالة لإغلاق الشريط الجانبي (Sidebar)
    // =============================================
    function toggleSidebar() {
      if (sidebar.classList.contains("opened")) {
        sidebar.classList.remove("opened");
        sidebar.classList.add("closed");
      } else {
        sidebar.classList.remove("closed");
        sidebar.classList.add("opened");
      }
    }

    // =============================================
    // دالة للتمرير إلى القسم المطلوب عند الضغط على الروابط
    // =============================================
    function scrollToSection(sectionId) {
      const section = document.getElementById(sectionId);
      if (!section) return;
      section.scrollIntoView({ behavior: "smooth" });
      // إخفاء الشريط الجانبي في الشاشات الصغيرة بعد اختيار القسم
      if (window.innerWidth <= 768) {
        sidebar.classList.remove("opened");
        sidebar.classList.add("closed");
      }
    }

    // =============================================
    // إعداد عرض المنتجات - تقطيع إلى صفحات/دفعات
    // =============================================
    let productsPerPage = 6;
    let currentPage = 1;
    let allProducts = [];       // سيتم جلبها من Firestore
    let filteredProducts = [];  // نحتفظ بها داخليّاً لتصفية/فرز

    // =============================================
    // دالة لإظهار Skeleton Loader أثناء استدعاء البيانات
    // =============================================
    function showSkeleton(count) {
      productGrid.innerHTML = "";
      for (let i = 0; i < count; i++) {
        const skeleton = document.createElement("div");
        skeleton.style.backgroundColor = "#ddd";
        skeleton.style.height = "360px";
        skeleton.style.borderRadius = "12px";
        skeleton.style.animation = "pulse 1.5s infinite ease-in-out";
        productGrid.appendChild(skeleton);
      }
    }

    // =============================================
    // دالة لإظهار المنتجات من Firestore (Render Products)
    // =============================================
    function renderProducts(resetPagination = true) {
      // نُظهر Skeleton في أثناء تحميل البيانات الجديدة
      showSkeleton(productsPerPage);

      // لجلب جميع المنتجات من Firestore، ثم التصفية والفرز والصفحة
      db.collection("products").orderBy("timestamp", "desc").get()
        .then((querySnapshot) => {
          // إعادة بناء المصفوفة من بيانات Firestore
          allProducts = [];
          querySnapshot.forEach((doc) => {
            const data = doc.data();
            allProducts.push({
              id: doc.id,
              name: data.name,
              desc: data.desc,
              priceNow: data.priceNow,
              priceBefore: data.priceBefore,
              size: data.size,
              discount: data.discount,
              images: data.images,       // array of Base64 strings
              timestamp: data.timestamp  // لتحديد الترتيب الزمني
            });
          });

          // الآن بعد أن جهزنا allProducts، نطبق التصفية والفرز
          applyFiltersAndSorting(resetPagination);
        })
        .catch((error) => {
          console.error("خطأ في جلب البيانات من Firestore: ", error);
          productGrid.innerHTML = `<p style="grid-column: 1/-1; text-align: center; font-size:18px; color:var(--color-text-light);">حدث خطأ أثناء تحميل المنتجات. حاول إعادة تحميل الصفحة.</p>`;
          loadMoreContainer.style.display = "none";
        });
    }

    // =============================================
    // دالة لتطبيق الفلاتر والترتيب ثم عرض الصفحة المطلوبة
    // =============================================
    function applyFiltersAndSorting(resetPagination) {
      // أخذ قيم البحث والفلاتر
      const searchTerm = searchInput.value.trim().toLowerCase();
      const sizeValue = filterSize.value;
      const discountValue = filterDiscount.value;
      const priceRangeValue = filterPriceRange.value;

      // تنقية نافذة allProducts
      filteredProducts = allProducts.filter((p) => {
        const matchesSearch =
          p.name.toLowerCase().includes(searchTerm) ||
          p.desc.toLowerCase().includes(searchTerm);
        const matchesSize = sizeValue ? p.size === sizeValue : true;
        const matchesDiscount = discountValue
          ? p.discount >= parseInt(discountValue)
          : true;

        let matchesPrice = true;
        if (priceRangeValue) {
          const parts = priceRangeValue.split("-");
          const minPrice = parseFloat(parts[0]);
          const maxPrice = parts[1] !== "" ? parseFloat(parts[1]) : null;
          if (maxPrice !== null) {
            matchesPrice = p.priceNow >= minPrice && p.priceNow <= maxPrice;
          } else {
            matchesPrice = p.priceNow >= minPrice;
          }
        }

        return matchesSearch && matchesSize && matchesDiscount && matchesPrice;
      });

      // تطبيق الفرز إن وجد
      applySorting();

      // إعادة ضبط الصفحة الحالية إذا لزم الأمر
      if (resetPagination) {
        currentPage = 1;
      }

      // تحديد المنتجات الظاهرة بناءً على الصفحة
      const startIdx = (currentPage - 1) * productsPerPage;
      const endIdx = startIdx + productsPerPage;
      const productsToShow = filteredProducts.slice(startIdx, endIdx);

      // مسح محتوى الشبكة
      productGrid.innerHTML = "";

      // إذا لم توجد منتجات مطابقة
      if (filteredProducts.length === 0) {
        productGrid.innerHTML =
          '<p style="grid-column: 1/-1; text-align: center; font-size:18px; color:var(--color-text-light);">لا توجد منتجات مطابقة للبحث أو الفلاتر.</p>';
        loadMoreContainer.style.display = "none";
        return;
      }

      // إنشاء بطاقات المنتجات وعرضها
      productsToShow.forEach((p) => {
        const card = document.createElement("div");
        card.classList.add("product-card");

        // بناء كود البطاقة
        let cardHTML = `
          <div class="discount">${p.discount}%</div>
          <div class="reference">#${p.id.slice(0,5)}</div>
          <div class="image-wrapper" onmouseenter="startImageHover('${p.id}', this)" onmouseleave="stopImageHover('${p.id}', this)">
            <img src="${p.images[0]}" alt="${p.name}" loading="lazy" onclick="openProductModal('${p.id}')">
          </div>
          <div class="card-content">
            <h4>${p.name}</h4>
            <p class="desc">${p.desc}</p>
            <div class="price-section">
              <span class="old-price">${p.priceBefore} $</span>
              <span class="current-price">${p.priceNow} $</span>
            </div>
            <p class="details"><i class="fas fa-ruler-horizontal"></i> <span class="label">المقاس:</span> ${p.size}</p>
            <div class="btn-group">
              <a href="https://wa.me/967777766811?text=مرحباً،%20أود%20الاستفسار%20عن%3A%20${encodeURIComponent(
                p.name + "%20(رقم%20المرجع%20%23" + p.id.slice(0,5) + ")"
              )}" target="_blank" class="inquiry" aria-label="استفسار عن ${p.name}"><i class="fas fa-comment-dots"></i> استفسار</a>
              <a href="#" class="details-btn" onclick="openProductModal('${p.id}'); return false;" aria-label="تفاصيل ${p.name}"><i class="fas fa-eye"></i> التفاصيل</a>
            </div>
          </div>
        `;
        card.innerHTML = cardHTML;
        productGrid.appendChild(card);
      });

      // التحكم بظهور زر "تحميل المزيد"
      if (endIdx < filteredProducts.length) {
        loadMoreContainer.style.display = "block";
      } else {
        loadMoreContainer.style.display = "none";
      }
    }

    // =============================================
    // دالة لتطبيق الفرز (Sorting)
    // =============================================
    function applySorting() {
      const sortValue = sortOptions.value;
      if (sortValue === "priceAsc") {
        filteredProducts.sort((a, b) => a.priceNow - b.priceNow);
      } else if (sortValue === "priceDesc") {
        filteredProducts.sort((a, b) => b.priceNow - a.priceNow);
      } else if (sortValue === "discountDesc") {
        filteredProducts.sort((a, b) => b.discount - a.discount);
      }
    }

    // =============================================
    // دالة مرتبطة بتغيير خيارات الفرز وربطها بعملية العرض
    // =============================================
    function sortProducts() {
      renderProducts();
    }

    // =============================================
    // دالة لتحميل المزيد من المنتجات (Pagination)
    // =============================================
    function loadMoreProducts() {
      currentPage++;
      renderProducts(false);
    }

    // =============================================
    // دوال لترتيب صور بطاقة المنتج عند التحويم (Hover)
    // =============================================
    let hoverIntervals = {};
    function startImageHover(productId, wrapper) {
      const product = allProducts.find((p) => p.id === productId);
      if (!product || product.images.length < 2) return;
      let idx = 1;
      const imgElement = wrapper.querySelector("img");
      hoverIntervals[productId] = setInterval(() => {
        imgElement.src = product.images[idx];
        idx = (idx + 1) % product.images.length;
      }, 1000);
    }
    function stopImageHover(productId, wrapper) {
      clearInterval(hoverIntervals[productId]);
      const product = allProducts.find((p) => p.id === productId);
      if (!product) return;
      wrapper.querySelector("img").src = product.images[0];
    }

    // =============================================
    // دالة لفتح نافذة تفاصيل المنتج وعرض المعلومات
    // =============================================
    function openProductModal(productId) {
      // إيجاد المنتج حسب المعرف
      const product = allProducts.find((item) => item.id === productId);
      if (!product) return;

      // وضع البيانات في النافذة
      modalTitle.textContent = product.name;
      modalRef.textContent = "رقم المرجع: #" + product.id.slice(0,5);
      modalDesc.textContent = product.desc;
      modalPrice.textContent = product.priceNow + " $";
      modalOldPrice.textContent = product.priceBefore + " $";
      modalSize.textContent = product.size;
      modalDiscount.textContent = product.discount + "%";

      // الصور
      modalImage1.src = product.images[0] || "";
      modalImage2.src = product.images[1] || product.images[0] || "";
      modalImage3.src = product.images[2] || product.images[0] || "";

      // تحديث زر واتساب لرسالة مخصصة
      modalWhatsappBtn.onclick = function () {
        const text = `مرحباً، أود الاستفسار عن: ${product.name} (رقم المرجع #${product.id.slice(0,5)})`;
        window.open(`https://wa.me/967777766811?text=${encodeURIComponent(text)}`, "_blank");
      };

      // إظهار النافذة
      productModal.classList.add("active");
      document.body.style.overflow = "hidden"; // منع التمرير بالخلفية
    }

    // =============================================
    // دالة لإغلاق نافذة التفاصيل
    // =============================================
    function closeProductModal() {
      productModal.classList.remove("active");
      document.body.style.overflow = ""; // استعادة التمرير
    }

    // =============================================
    // دالة لفتح نافذة تسجيل الدخول (Login Modal)
    // =============================================
    function openLoginModal() {
      loginModal.classList.add("active");
      document.body.style.overflow = "hidden";
    }

    // =============================================
    // دالة لإغلاق نافذة تسجيل الدخول
    // =============================================
    function closeLoginModal() {
      loginModal.classList.remove("active");
      document.body.style.overflow = "";
    }

    // =============================================
    // دالة لفتح نافذة لوحة الإدارة (Admin Panel Modal)
    // =============================================
    function openAdminModal() {
      adminModal.classList.add("active");
      document.body.style.overflow = "hidden";
      // افتراضيًا قسم الإضافة ظاهر
      switchAdminTab("add");
      populateAdminList();
    }

    // =============================================
    // دالة لإغلاق نافذة لوحة الإدارة
    // =============================================
    function closeAdminModal() {
      adminModal.classList.remove("active");
      document.body.style.overflow = "";
      document.getElementById("addProductForm").reset();
      editingProductIdInput.value = "";
      addUpdateBtn.innerHTML = '<i class="fas fa-plus"></i> إضافة الفستان';
    }

    // =============================================
    // دالة لتبديل تبويبات الإدارة
    // =============================================
    function switchAdminTab(tab) {
      if (tab === "add") {
        adminSectionAdd.classList.add("active");
        adminSectionManage.classList.remove("active");
        tabAdd.classList.add("active");
        tabManage.classList.remove("active");
      } else {
        adminSectionAdd.classList.remove("active");
        adminSectionManage.classList.add("active");
        tabAdd.classList.remove("active");
        tabManage.classList.add("active");
      }
    }

    // =============================================
    // دالة لملء قائمة الإدارة بالمنتجات
    // =============================================
    function populateAdminList() {
      // نعيد جلب المنتجات من Firestore
      db.collection("products").orderBy("timestamp", "desc").get()
        .then((querySnapshot) => {
          adminList.innerHTML = "";
          if (querySnapshot.empty) {
            adminList.innerHTML = `<p style="text-align:center; color:var(--color-text-light);">لا توجد منتجات لإدارتها.</p>`;
            return;
          }
          querySnapshot.forEach((doc) => {
            const data = doc.data();
            const item = document.createElement("div");
            item.classList.add("admin-item");
            item.innerHTML = `
              <span>#${doc.id.slice(0,5)} - ${data.name}</span>
              <div class="actions">
                <button class="edit" onclick="prepareEditProduct('${doc.id}')">تعديل</button>
                <button class="delete" onclick="deleteProduct('${doc.id}')">حذف</button>
              </div>
            `;
            adminList.appendChild(item);
          });
        })
        .catch((error) => {
          console.error("خطأ في جلب قائمة الإدارة:", error);
          adminList.innerHTML = `<p style="text-align:center; color:var(--color-text-light);">حدث خطأ أثناء جلب المنتجات.</p>`;
        });
    }

    // =============================================
    // دالة لتحضير نموذج تعديل منتج بالمعلومات المسبقة
    // =============================================
    function prepareEditProduct(productId) {
      // نبحث في allProducts عن هذا المعرف
      const product = allProducts.find((p) => p.id === productId);
      if (!product) return;
      openAdminModal();
      switchAdminTab("add");

      // تعبئة الحقول
      editingProductIdInput.value = product.id;
      document.getElementById("newDressName").value = product.name;
      document.getElementById("newDressDesc").value = product.desc;
      document.getElementById("newPriceNow").value = product.priceNow;
      document.getElementById("newPriceBefore").value = product.priceBefore;
      document.getElementById("newSize").value = product.size;
      document.getElementById("newDiscount").value = product.discount;

      // تغيير زر الحفظ
      addUpdateBtn.innerHTML = '<i class="fas fa-save"></i> حفظ التعديلات';
    }

    // =============================================
    // دالة لحذف منتج
    // =============================================
    function deleteProduct(productId) {
      if (!confirm("هل أنت متأكد أنك تريد حذف هذا المنتج؟")) return;
      db.collection("products").doc(productId).delete()
        .then(() => {
          alert("تم حذف الفستان بنجاح.");
          renderProducts();
          populateAdminList();
        })
        .catch((error) => {
          console.error("خطأ في حذف المنتج:", error);
          alert("حدث خطأ أثناء الحذف. حاول مرة أخرى.");
        });
    }

    // =============================================
    // دالة لإضافة أو تعديل منتج جديد (باستخدام Firestore)
    // =============================================
    function handleAddOrUpdateProduct(event) {
      event.preventDefault();

      const idEditing = editingProductIdInput.value;
      const name = document.getElementById("newDressName").value.trim();
      const desc = document.getElementById("newDressDesc").value.trim();
      const priceNow = parseFloat(document.getElementById("newPriceNow").value);
      const priceBefore = parseFloat(document.getElementById("newPriceBefore").value);
      const size = document.getElementById("newSize").value.trim();
      const discount = parseInt(document.getElementById("newDiscount").value);

      const fileInput1 = document.getElementById("newImage1");
      const fileInput2 = document.getElementById("newImage2");
      const fileInput3 = document.getElementById("newImage3");

      // مساعدة لتحويل ملف إلى Base64
      function fileToBase64(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.readAsDataURL(file);
          reader.onload = () => resolve(reader.result);
          reader.onerror = (error) => reject(error);
        });
      }

      // إذا كان التعديل (idEditing غير فارغ)
      if (idEditing) {
        // نبني كائن يحتوي الحقول الأساسية التي قد تتغير
        const updatedData = {
          name,
          desc,
          priceNow,
          priceBefore,
          size,
          discount
        };

        // نجمع وعود قراءة الصور المُحمّلة (إذا وُجدت)
        const promises = [];
        if (fileInput1.files[0]) promises.push(fileToBase64(fileInput1.files[0]));
        if (fileInput2.files[0]) promises.push(fileToBase64(fileInput2.files[0]));
        if (fileInput3.files[0]) promises.push(fileToBase64(fileInput3.files[0]));

        // إذا هناك على الأقل ملف واحد
        if (promises.length > 0) {
          Promise.all(promises)
            .then((base64Images) => {
              // نجلب البيانات الحالية من Firestore أولاً
              db.collection("products").doc(idEditing).get()
                .then((doc) => {
                  if (!doc.exists) {
                    alert("المنتج غير موجود أو تم حذفه مسبقاً.");
                    return;
                  }
                  const currentData = doc.data();
                  const imagesArray = currentData.images || [];
                  // ندمج الصور الجديدة مع الصور الحالية
                  base64Images.forEach((imgBase64, idx) => {
                    imagesArray[idx] = imgBase64;
                  });
                  updatedData.images = imagesArray;

                  // ننفّذ التحديث
                  db.collection("products").doc(idEditing).update(updatedData)
                    .then(() => {
                      alert("تم حفظ التعديلات بنجاح!");
                      renderProducts();
                      populateAdminList();
                      document.getElementById("addProductForm").reset();
                      editingProductIdInput.value = "";
                      addUpdateBtn.innerHTML = '<i class="fas fa-plus"></i> إضافة الفستان';
                    })
                    .catch((error) => {
                      console.error("خطأ في تحديث المنتج:", error);
                      alert("حدث خطأ أثناء حفظ التعديلات. حاول مرة أخرى.");
                    });
                })
                .catch((error) => {
                  console.error("خطأ في جلب المنتج للتعديل:", error);
                  alert("حدث خطأ أثناء عملية التعديل. حاول مرة أخرى.");
                });
            })
            .catch((error) => {
              console.error("خطأ في قراءة الصور:", error);
              alert("حدث خطأ أثناء رفع الصور. حاول مرة أخرى.");
            });
        } else {
          // إذا لم تُحمّل أي صورة جديدة فنحدث فقط الحقول النصية/الرقمية
          db.collection("products").doc(idEditing).update(updatedData)
            .then(() => {
              alert("تم حفظ التعديلات بنجاح!");
              renderProducts();
              populateAdminList();
              document.getElementById("addProductForm").reset();
              editingProductIdInput.value = "";
              addUpdateBtn.innerHTML = '<i class="fas fa-plus"></i> إضافة الفستان';
            })
            .catch((error) => {
              console.error("خطأ في تحديث المنتج:", error);
              alert("حدث خطأ أثناء حفظ التعديلات. حاول مرة أخرى.");
            });
        }

      } else {
        // إضافة منتج جديد
        if (!fileInput1.files[0]) {
          alert("يرجى رفع صورة واحدة على الأقل للفستان.");
          return;
        }
        // نقرأ الصور المختارة (الحد الأدنى صورة أولى، والباقي اختياري)
        const promises = [];
        promises.push(fileToBase64(fileInput1.files[0]));
        if (fileInput2.files[0]) promises.push(fileToBase64(fileInput2.files[0]));
        if (fileInput3.files[0]) promises.push(fileToBase64(fileInput3.files[0]));

        Promise.all(promises)
          .then((base64Images) => {
            const newId = db.collection("products").doc().id; // نأخذ المعرف من Firestore
            // ننشئ الكائن الجديد
            const newProduct = {
              name: name,
              desc: desc,
              priceNow: priceNow,
              priceBefore: priceBefore,
              size: size,
              discount: discount,
              images: base64Images,
              timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };
            // نضيف إلى Firestore
            db.collection("products").doc(newId).set(newProduct)
              .then(() => {
                alert("تمت إضافة الفستان بنجاح!");
                renderProducts();
                populateAdminList();
                document.getElementById("addProductForm").reset();
              })
              .catch((error) => {
                console.error("خطأ في إضافة المنتج الجديد:", error);
                alert("حدث خطأ أثناء إضافة الفستان. حاول مرة أخرى.");
              });
          })
          .catch((error) => {
            console.error("خطأ في قراءة الصور:", error);
            alert("حدث خطأ أثناء رفع الصور. حاول مرة أخرى.");
          });
      }
    }

    // =============================================
    // دالة لتقديم نموذج الاتصال في قسم تواصل معنا
    // =============================================
    function submitContactForm(event) {
      event.preventDefault();
      const name = document.getElementById("contactName").value.trim();
      const email = document.getElementById("contactEmail").value.trim();
      const message = document.getElementById("contactMessage").value.trim();

      if (!name || !email || !message) {
        alert("يرجى تعبئة جميع الحقول.");
        return;
      }

      // في هذه النسخة البسيطة، نقوم فقط بعرض تنبيه
      alert("تم استلام رسالتك. شكرًا لتواصلك معنا!");
      document.getElementById("contactName").value = "";
      document.getElementById("contactEmail").value = "";
      document.getElementById("contactMessage").value = "";
    }

    // =============================================
    // دالة لتسجيل الدخول من النافذة المنبثقة
    // =============================================
    function handleLogin(event) {
      event.preventDefault();
      const username = document.getElementById("loginUser").value.trim();
      const password = document.getElementById("loginPass").value.trim();

      if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
        closeLoginModal();
        openAdminModal();
        document.getElementById("loginUser").value = "";
        document.getElementById("loginPass").value = "";
      } else {
        alert("بيانات الدخول غير صحيحة.");
      }
    }

    // =============================================
    // دالة لإظهار زر العودة للأعلى عند الاقتراب من الأسفل
    // =============================================
    window.addEventListener("scroll", () => {
      if (window.scrollY > 300) {
        backToTop.classList.add("show");
      } else {
        backToTop.classList.remove("show");
      }
    });
    backToTop.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // =============================================
    // إغلاق النوافذ المنبثقة عند النقر خارج المحتوى
    // =============================================
    window.addEventListener("click", function (event) {
      if (event.target === productModal) {
        closeProductModal();
      }
      if (event.target === loginModal) {
        closeLoginModal();
      }
      if (event.target === adminModal) {
        closeAdminModal();
      }
    });

    // =============================================
    // تحميل وعرض المنتجات عند تحميل الصفحة
    // =============================================
    window.addEventListener("DOMContentLoaded", () => {
      renderProducts();
    });

    // =============================================
    // تسجيل عدد زيارات الصفحة (مثال بسيط)
    // =============================================
    (function countVisits() {
      let visits = parseInt(localStorage.getItem("visits") || "0");
      visits++;
      localStorage.setItem("visits", visits);
      console.log(`عدد زيارات المستخدم للموقع: ${visits}`);
    })();
  </script>
</body>
</html>
